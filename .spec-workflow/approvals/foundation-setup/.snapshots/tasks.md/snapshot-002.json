{
  "id": "snapshot_1762779565920_tbz1cceli",
  "approvalId": "approval_1762779078106_wanr25eoo",
  "approvalTitle": "Foundation Setup - Tasks Document",
  "version": 2,
  "timestamp": "2025-11-10T12:59:25.920Z",
  "trigger": "approved",
  "status": "pending",
  "content": "# Tasks Document: Foundation Setup\n\n## Task Overview\n\nThis document breaks down the Foundation Setup into **12 sequential tasks** following the optimized implementation sequence from the Design Document. Each task is atomic (1-3 files), includes detailed prompts for AI agents, and references the specific requirements it implements.\n\n**Total Estimated Time:** 8-12 hours (for experienced developer or AI agent)\n**Total Files:** ~40 files\n\n---\n\n## Task 1: Project Initialization\n\n- [-] **1. Initialize Next.js 15 project with pnpm and TypeScript**\n  - **Files to create:**\n    - Root project structure (via `pnpm create next-app@latest`)\n    - `package.json` (with pnpm packageManager field)\n    - `tsconfig.json` (with strict mode and path aliases)\n    - Initial `next.config.js`\n  - **Purpose:** Create base Next.js 15 project with App Router and TypeScript\n  - **Leverage:** None (greenfield initialization)\n  - **Requirements:** Requirement 1 (Project Initialization)\n  - **Success Criteria:**\n    - `pnpm create next-app@latest` runs successfully\n    - Project uses Next.js 15+, React 19+, TypeScript 5.3+\n    - `packageManager` field set to \"pnpm@8.15.0\" in package.json\n    - `tsconfig.json` has strict mode enabled and path aliases configured\n    - `pnpm dev` starts development server successfully\n\n  - **_Prompt:**\n    ```\n    Implement the task for spec foundation-setup, first run spec-workflow-guide to get the workflow guide then implement the task:\n\n    Role: Full-stack Developer with expertise in Next.js, TypeScript, and pnpm\n\n    Task: Initialize a new Next.js 15 project with App Router, TypeScript strict mode, and pnpm as the package manager. Configure path aliases for clean imports (@/* → ./src/*). Follow Requirement 1 from requirements.md.\n\n    Steps:\n    1. Run `pnpm create next-app@latest` with options:\n       - TypeScript: Yes\n       - ESLint: Yes\n       - Tailwind CSS: Yes (we'll configure custom theme later)\n       - `src/` directory: Yes\n       - App Router: Yes\n       - Import alias: @/*\n    2. Add `\"packageManager\": \"pnpm@8.15.0\"` to package.json\n    3. Verify tsconfig.json has:\n       - `\"strict\": true`\n       - Path aliases: `\"@/*\": [\"./src/*\"]`\n    4. Install core dependencies:\n       - next@^15.0.0\n       - react@^19.0.0\n       - react-dom@^19.0.0\n       - typescript@^5.3.0\n    5. Test: Run `pnpm dev` and verify server starts on http://localhost:3000\n\n    Restrictions:\n    - Do NOT use npm or yarn, only pnpm\n    - Do NOT use Pages Router, only App Router\n    - Do NOT disable TypeScript strict mode\n    - Do NOT skip the src/ directory option\n\n    Success:\n    - `pnpm dev` starts without errors\n    - TypeScript compilation succeeds\n    - Path aliases work (can import with @/...)\n    - Project follows structure.md \"Directory Organization\"\n\n    After completion:\n    - Mark this task as in-progress in tasks.md: Change [ ] to [-]\n    - After completing implementation and testing, use log-implementation tool with:\n      - taskId: \"1\"\n      - summary: \"Initialized Next.js 15 project with pnpm, TypeScript strict mode, and App Router. Configured path aliases and verified dev server starts successfully.\"\n      - filesModified: [\"package.json\", \"tsconfig.json\", \"next.config.js\"]\n      - filesCreated: [\".gitignore\", \"README.md\", \"app/page.tsx\", \"app/layout.tsx\", \"app/globals.css\"]\n      - statistics: {linesAdded: ~200, linesRemoved: 0}\n      - artifacts: {\n          \"components\": [],\n          \"functions\": [],\n          \"classes\": [],\n          \"apiEndpoints\": [],\n          \"integrations\": []\n        }\n    - Then mark task as complete in tasks.md: Change [-] to [x]\n    ```\n\n---\n\n## Task 2: Configuration Files\n\n- [ ] **2. Create project configuration files (.editorconfig, .gitignore, .env.example, ESLint, Prettier)**\n  - **Files to create:**\n    - `.editorconfig`\n    - `.gitignore` (update existing)\n    - `.env.example`\n    - `.eslintrc.json` (update existing)\n    - `.prettierrc`\n    - `package.json` (update with Prettier plugin)\n  - **Purpose:** Establish code quality standards and document environment variables\n  - **Leverage:** Existing .gitignore from create-next-app\n  - **Requirements:** Requirement 7 (Development Scripts), Requirement 8 (ESLint & Prettier), Requirement 10 (Environment Variables)\n  - **Success Criteria:**\n    - `.editorconfig` defines indent, line endings, charset\n    - `.gitignore` excludes build artifacts but DOES NOT ignore prisma/migrations/\n    - `.env.example` documents all required env vars\n    - ESLint extends next/core-web-vitals\n    - Prettier configured with Tailwind plugin\n    - `pnpm lint` and `pnpm format` work\n\n  - **_Prompt:**\n    ```\n    Implement the task for spec foundation-setup, first run spec-workflow-guide to get the workflow guide then implement the task:\n\n    Role: DevOps Engineer with expertise in project configuration and code quality tools\n\n    Task: Create and configure all project-level configuration files for code quality, environment variables, and editor consistency. Follow Requirements 7, 8, and 10 from requirements.md.\n\n    Steps:\n    1. Create `.editorconfig`:\n       - indent_style = space, indent_size = 2\n       - end_of_line = lf, charset = utf-8\n       - trim_trailing_whitespace = true, insert_final_newline = true\n\n    2. Update `.gitignore` (IMPORTANT - per requirements.md Requirement 7 AC 4):\n       - Add: node_modules/, .next/, out/\n       - Add: .env, .env.local, .env*.local\n       - Add: .DS_Store, *.log\n       - **CRITICAL:** Ensure prisma/migrations/ is NOT in .gitignore (must be committed)\n\n    3. Create `.env.example`:\n       ```\n       # Database\n       DATABASE_URL=\"postgresql://user:pass@localhost:5432/decari_dev\"\n\n       # PostHog (Analytics + Meta Integration)\n       NEXT_PUBLIC_POSTHOG_KEY=\"phc_...\"\n       NEXT_PUBLIC_POSTHOG_HOST=\"https://eu.posthog.com\"\n\n       # cal.com\n       NEXT_PUBLIC_CAL_LINK=\"https://cal.com/decari/erstberatung\"\n       CAL_WEBHOOK_SECRET=\"whsec_...\"\n\n       # n8n\n       N8N_WEBHOOK_URL=\"https://n8n.decari.de/webhook/lead-submit\"\n       N8N_WEBHOOK_SECRET=\"whsec_...\"\n       ```\n\n    4. Update `.eslintrc.json`:\n       ```json\n       {\n         \"extends\": [\"next/core-web-vitals\"],\n         \"rules\": {}\n       }\n       ```\n\n    5. Create `.prettierrc`:\n       ```json\n       {\n         \"semi\": false,\n         \"singleQuote\": false,\n         \"tabWidth\": 2,\n         \"printWidth\": 100,\n         \"trailingComma\": \"es5\",\n         \"plugins\": [\"prettier-plugin-tailwindcss\"]\n       }\n       ```\n\n    6. Install Prettier and plugin:\n       `pnpm add -D prettier prettier-plugin-tailwindcss`\n\n    7. Add npm scripts to package.json:\n       - \"format\": \"prettier --write .\"\n       - \"format:check\": \"prettier --check .\"\n\n    8. Test: Run `pnpm lint` and `pnpm format`\n\n    Restrictions:\n    - Do NOT add prisma/migrations/ to .gitignore\n    - Do NOT modify core Next.js ESLint rules\n    - Do NOT add custom ESLint rules (KISS principle)\n    - Ensure .env.example is committed (but .env.local is not)\n\n    Success:\n    - `pnpm lint` runs without errors\n    - `pnpm format` formats all files consistently\n    - `.env.example` documents all required variables\n    - prisma/migrations/ will be committed to git\n    - Editor respects .editorconfig settings\n\n    After completion:\n    - Use log-implementation tool with taskId \"2\"\n    - Mark task as complete in tasks.md\n    ```\n\n---\n\n## Task 3: Testing Infrastructure\n\n- [ ] **3. Configure Vitest and Playwright for unit and E2E testing**\n  - **Files to create:**\n    - `vitest.config.ts`\n    - `playwright.config.ts`\n    - `tests/unit/.gitkeep`\n    - `tests/e2e/.gitkeep`\n    - `package.json` (update with test scripts)\n  - **Purpose:** Establish testing infrastructure early for TDD-light approach\n  - **Leverage:** None (first testing setup)\n  - **Requirements:** Requirement 9 (Testing Framework Setup)\n  - **Success Criteria:**\n    - Vitest configured with jsdom environment\n    - Playwright configured for chromium + mobile chrome\n    - Test directories created\n    - `pnpm test` and `pnpm e2e` scripts work\n    - Dependencies installed\n\n  - **_Prompt:**\n    ```\n    Implement the task for spec foundation-setup, first run spec-workflow-guide to get the workflow guide then implement the task:\n\n    Role: QA Engineer with expertise in testing frameworks (Vitest, Playwright)\n\n    Task: Configure Vitest for unit testing and Playwright for E2E testing. Create test directory structure. Follow Requirement 9 from requirements.md and testing strategy from design.md.\n\n    Steps:\n    1. Install testing dependencies:\n       ```bash\n       pnpm add -D vitest @testing-library/react @testing-library/jest-dom @vitejs/plugin-react\n       pnpm add -D playwright @playwright/test\n       ```\n\n    2. Create `vitest.config.ts`:\n       ```typescript\n       import { defineConfig } from 'vitest/config'\n       import react from '@vitejs/plugin-react'\n       import path from 'path'\n\n       export default defineConfig({\n         plugins: [react()],\n         test: {\n           environment: 'jsdom',\n           setupFiles: ['./tests/setup.ts'],\n         },\n         resolve: {\n           alias: {\n             '@': path.resolve(__dirname, './src'),\n           },\n         },\n       })\n       ```\n\n    3. Create `tests/setup.ts`:\n       ```typescript\n       import '@testing-library/jest-dom'\n       ```\n\n    4. Create `playwright.config.ts`:\n       ```typescript\n       import { defineConfig, devices } from '@playwright/test'\n\n       export default defineConfig({\n         testDir: './tests/e2e',\n         fullyParallel: true,\n         use: {\n           baseURL: 'http://localhost:3000',\n         },\n         projects: [\n           {\n             name: 'chromium',\n             use: { ...devices['Desktop Chrome'] },\n           },\n           {\n             name: 'mobile-chrome',\n             use: { ...devices['Pixel 5'] },\n           },\n         },\n         webServer: {\n           command: 'pnpm dev',\n           url: 'http://localhost:3000',\n           reuseExistingServer: !process.env.CI,\n         },\n       })\n       ```\n\n    5. Create test directories:\n       - `tests/unit/schemas/` (for Zod schema tests later)\n       - `tests/e2e/` (for Playwright tests)\n\n    6. Add npm scripts to package.json:\n       - \"test\": \"vitest\"\n       - \"test:coverage\": \"vitest --coverage\"\n       - \"e2e\": \"playwright test\"\n       - \"e2e:ui\": \"playwright test --ui\"\n\n    7. Install Playwright browsers: `pnpm exec playwright install`\n\n    Restrictions:\n    - Follow YAGNI testing strategy from tech.md (minimal tests in foundation)\n    - Do NOT configure complex coverage thresholds\n    - Do NOT add unnecessary testing plugins\n\n    Success:\n    - `pnpm test` runs (even with no tests yet)\n    - `pnpm e2e` can be run (will add tests later)\n    - Test directories exist and are ready for tests\n    - Vitest and Playwright configs are valid\n\n    After completion:\n    - Use log-implementation tool with taskId \"3\"\n    - Mark task as complete in tasks.md\n    ```\n\n---\n\n## Task 4: Basic Routing (App Shell)\n\n- [ ] **4. Create basic Next.js App Router structure (RootLayout, home page, error pages)**\n  - **Files to create/modify:**\n    - `app/layout.tsx` (update existing)\n    - `app/page.tsx` (update existing)\n    - `app/not-found.tsx`\n    - `app/error.tsx`\n    - `app/globals.css` (update existing)\n    - `app/(marketing)/.gitkeep`\n    - `app/(funnel)/.gitkeep`\n    - `app/api/.gitkeep`\n  - **Purpose:** Create runnable app shell - after this task, `pnpm dev` shows a working app\n  - **Leverage:** Existing app/layout.tsx and app/page.tsx from create-next-app\n  - **Requirements:** Requirement 11 (Basic Layout & Routing Structure)\n  - **Success Criteria:**\n    - RootLayout includes metadata and basic HTML structure\n    - Home page shows \"Decari MVP - Foundation Setup Complete\"\n    - 404 and error pages exist\n    - Route group directories created\n    - App runs without errors (`pnpm dev`)\n\n  - **_Prompt:**\n    ```\n    Implement the task for spec foundation-setup, first run spec-workflow-guide to get the workflow guide then implement the task:\n\n    Role: Frontend Developer with expertise in Next.js App Router and React\n\n    Task: Create basic App Router structure with RootLayout, home page, and error boundaries. Establish route group directories for future features. Follow Requirement 11 from requirements.md.\n\n    Steps:\n    1. Update `app/layout.tsx`:\n       ```tsx\n       import type { Metadata } from 'next'\n       import { Inter } from 'next/font/google'\n       import './globals.css'\n\n       const inter = Inter({ subsets: ['latin'] })\n\n       export const metadata: Metadata = {\n         title: 'Decari - Schulbegleitung einfach finden',\n         description: 'Qualifizierte Schulbegleitung für Ihr Kind. Schnell, transparent, professionell.',\n       }\n\n       export default function RootLayout({\n         children,\n       }: {\n         children: React.ReactNode\n       }) {\n         return (\n           <html lang=\"de\">\n             <body className={inter.className}>{children}</body>\n           </html>\n         )\n       }\n       ```\n\n    2. Update `app/page.tsx`:\n       ```tsx\n       export default function Home() {\n         return (\n           <main className=\"flex min-h-screen flex-col items-center justify-center p-24\">\n             <div className=\"text-center\">\n               <h1 className=\"text-4xl font-bold mb-4\">Decari MVP</h1>\n               <p className=\"text-xl text-gray-600\">Foundation Setup Complete</p>\n               <p className=\"text-sm text-gray-500 mt-4\">\n                 Next.js 15 • React 19 • TypeScript • Tailwind CSS 4\n               </p>\n             </div>\n           </main>\n         )\n       }\n       ```\n\n    3. Create `app/not-found.tsx`:\n       ```tsx\n       export default function NotFound() {\n         return (\n           <div className=\"flex min-h-screen flex-col items-center justify-center\">\n             <h2 className=\"text-2xl font-bold mb-2\">404 - Seite nicht gefunden</h2>\n             <p className=\"text-gray-600\">Diese Seite existiert nicht.</p>\n           </div>\n         )\n       }\n       ```\n\n    4. Create `app/error.tsx`:\n       ```tsx\n       'use client'\n\n       export default function Error({\n         error,\n         reset,\n       }: {\n         error: Error & { digest?: string }\n         reset: () => void\n       }) {\n         return (\n           <div className=\"flex min-h-screen flex-col items-center justify-center\">\n             <h2 className=\"text-2xl font-bold mb-2\">Ein Fehler ist aufgetreten</h2>\n             <button\n               onClick={() => reset()}\n               className=\"mt-4 px-4 py-2 bg-blue-500 text-white rounded\"\n             >\n               Erneut versuchen\n             </button>\n           </div>\n         )\n       }\n       ```\n\n    5. Create route group directories:\n       - `app/(marketing)/` - for public pages (landing, ratgeber, etc.)\n       - `app/(funnel)/` - for intake funnel\n       - `app/api/` - for API routes\n       (Add .gitkeep files to preserve empty directories)\n\n    6. Test: Run `pnpm dev` and visit http://localhost:3000\n\n    Restrictions:\n    - Do NOT add complex layouts yet (just basic structure)\n    - Do NOT add navigation/header/footer yet\n    - Use Tailwind classes only (no custom CSS beyond globals.css)\n    - Keep it simple (KISS principle)\n\n    Success:\n    - `pnpm dev` starts without errors\n    - Home page displays \"Decari MVP\" heading\n    - 404 page works (try http://localhost:3000/nonexistent)\n    - Error boundary can be tested\n    - Route group directories exist and ready for future features\n\n    After completion:\n    - Use log-implementation tool with taskId \"4\"\n    - Mark task as complete in tasks.md\n    ```\n\n---\n\n## Task 5: Tailwind CSS Custom Theme\n\n- [ ] **5. Configure Tailwind CSS 4 with custom theme (colors, fonts, spacing)**\n  - **Files to create/modify:**\n    - `tailwind.config.ts` (update existing)\n    - `app/globals.css` (update existing)\n  - **Purpose:** Establish design system foundation with brand colors and typography\n  - **Leverage:** Existing tailwind.config.ts from create-next-app\n  - **Requirements:** Requirement 2 (Tailwind CSS 4 Setup)\n  - **Success Criteria:**\n    - Custom theme colors defined (primary, secondary, accent)\n    - Font families configured\n    - CSS variables defined in globals.css\n    - Theme tokens work in components\n    - Tailwind 4.0+ installed\n\n  - **_Prompt:**\n    ```\n    Implement the task for spec foundation-setup, first run spec-workflow-guide to get the workflow guide then implement the task:\n\n    Role: UI/UX Developer with expertise in Tailwind CSS and design systems\n\n    Task: Configure Tailwind CSS 4 with custom theme including brand colors, typography, and design tokens. Follow Requirement 2 from requirements.md and design.md configuration section.\n\n    Steps:\n    1. Verify Tailwind 4.0+ is installed: `pnpm list tailwindcss`\n       If not 4.0+: `pnpm add -D tailwindcss@latest`\n\n    2. Update `tailwind.config.ts`:\n       ```typescript\n       import type { Config } from 'tailwindcss'\n\n       const config: Config = {\n         content: [\n           './app/**/*.{js,ts,jsx,tsx,mdx}',\n           './src/components/**/*.{js,ts,jsx,tsx,mdx}',\n         ],\n         theme: {\n           extend: {\n             colors: {\n               primary: {\n                 50: '#eff6ff',\n                 100: '#dbeafe',\n                 200: '#bfdbfe',\n                 300: '#93c5fd',\n                 400: '#60a5fa',\n                 500: '#3b82f6',  // Base primary\n                 600: '#2563eb',\n                 700: '#1d4ed8',\n                 800: '#1e40af',\n                 900: '#1e3a8a',\n                 950: '#172554',\n               },\n               secondary: {\n                 50: '#f0fdf4',\n                 100: '#dcfce7',\n                 200: '#bbf7d0',\n                 300: '#86efac',\n                 400: '#4ade80',\n                 500: '#22c55e',  // Base secondary\n                 600: '#16a34a',\n                 700: '#15803d',\n                 800: '#166534',\n                 900: '#14532d',\n                 950: '#052e16',\n               },\n               accent: {\n                 50: '#fff7ed',\n                 100: '#ffedd5',\n                 200: '#fed7aa',\n                 300: '#fdba74',\n                 400: '#fb923c',\n                 500: '#f97316',  // Base accent\n                 600: '#ea580c',\n                 700: '#c2410c',\n                 800: '#9a3412',\n                 900: '#7c2d12',\n                 950: '#431407',\n               },\n             },\n             fontFamily: {\n               display: ['Inter', 'sans-serif'],\n               body: ['Inter', 'sans-serif'],\n             },\n             borderRadius: {\n               'theme-sm': '0.25rem',\n               'theme-md': '0.5rem',\n               'theme-lg': '1rem',\n             },\n           },\n         },\n         plugins: [],\n       }\n\n       export default config\n       ```\n\n    3. Update `app/globals.css`:\n       ```css\n       @tailwind base;\n       @tailwind components;\n       @tailwind utilities;\n\n       @layer base {\n         :root {\n           --color-primary: 210 100% 50%;\n           --color-secondary: 140 60% 45%;\n           --color-accent: 25 95% 50%;\n         }\n\n         * {\n           @apply border-border;\n         }\n\n         body {\n           @apply bg-white text-gray-900;\n           font-feature-settings: 'rlig' 1, 'calt' 1;\n         }\n       }\n       ```\n\n    4. Test theme on home page (update app/page.tsx temporarily):\n       Add: `<div className=\"bg-primary-500 text-white p-4 rounded-theme-md\">Theme Test</div>`\n\n    5. Verify: Run `pnpm dev` and check that custom colors work\n\n    Restrictions:\n    - Use Tailwind 4.0+ only (not older versions)\n    - Do NOT add unnecessary Tailwind plugins (KISS)\n    - Follow the exact color palette structure (50-950 shades)\n    - Do NOT use inline styles or CSS Modules\n\n    Success:\n    - Custom colors work (text-primary-500, bg-secondary-100, etc.)\n    - Font family applies (Inter via next/font)\n    - Border radius tokens work (rounded-theme-md)\n    - CSS variables defined and accessible\n    - Tailwind IntelliSense shows custom theme tokens\n\n    After completion:\n    - Use log-implementation tool with taskId \"5\"\n    - Mark task as complete in tasks.md\n    ```\n\n---\n\n## Task 6: shadcn/ui Component Library\n\n- [ ] **6. Install and configure shadcn/ui with 8 base components**\n  - **Files to create:**\n    - `src/components/ui/button.tsx`\n    - `src/components/ui/card.tsx`\n    - `src/components/ui/input.tsx`\n    - `src/components/ui/label.tsx`\n    - `src/components/ui/dialog.tsx`\n    - `src/components/ui/select.tsx`\n    - `src/components/ui/checkbox.tsx`\n    - `src/components/ui/radio-group.tsx`\n    - `src/lib/utils/cn.ts`\n    - `components.json` (shadcn config)\n  - **Purpose:** Establish accessible UI component library for all features\n  - **Leverage:** Tailwind theme from Task 5\n  - **Requirements:** Requirement 3 (shadcn/ui Component Library)\n  - **Success Criteria:**\n    - shadcn/ui initialized\n    - 8 base components installed\n    - cn() utility created\n    - Components use custom theme\n    - All components render without errors\n\n  - **_Prompt:**\n    ```\n    Implement the task for spec foundation-setup, first run spec-workflow-guide to get the workflow guide then implement the task:\n\n    Role: Frontend Developer with expertise in shadcn/ui and React component libraries\n\n    Task: Initialize shadcn/ui and install 8 base components (button, card, input, label, dialog, select, checkbox, radio-group). Create cn() utility for className merging. Follow Requirement 3 from requirements.md.\n\n    Steps:\n    1. Initialize shadcn/ui:\n       ```bash\n       pnpm dlx shadcn-ui@latest init\n       ```\n       Select options:\n       - Style: Default\n       - Base color: Slate\n       - CSS variables: Yes\n       - Components directory: src/components/ui\n       - Utils location: src/lib/utils\n       - React Server Components: Yes\n\n    2. Install 8 base components:\n       ```bash\n       pnpm dlx shadcn-ui@latest add button\n       pnpm dlx shadcn-ui@latest add card\n       pnpm dlx shadcn-ui@latest add input\n       pnpm dlx shadcn-ui@latest add label\n       pnpm dlx shadcn-ui@latest add dialog\n       pnpm dlx shadcn-ui@latest add select\n       pnpm dlx shadcn-ui@latest add checkbox\n       pnpm dlx shadcn-ui@latest add radio-group\n       ```\n\n    3. Verify `src/lib/utils/cn.ts` was created:\n       ```typescript\n       import { type ClassValue, clsx } from 'clsx'\n       import { twMerge } from 'tailwind-merge'\n\n       export function cn(...inputs: ClassValue[]) {\n         return twMerge(clsx(inputs))\n       }\n       ```\n\n    4. Test components on home page (app/page.tsx):\n       ```tsx\n       import { Button } from '@/components/ui/button'\n       import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\n       import { Input } from '@/components/ui/input'\n       import { Label } from '@/components/ui/label'\n\n       // Add to page:\n       <Card className=\"max-w-md mt-8\">\n         <CardHeader>\n           <CardTitle>shadcn/ui Test</CardTitle>\n         </CardHeader>\n         <CardContent className=\"space-y-4\">\n           <div>\n             <Label htmlFor=\"test\">Test Input</Label>\n             <Input id=\"test\" placeholder=\"Type something...\" />\n           </div>\n           <Button>Test Button</Button>\n         </CardContent>\n       </Card>\n       ```\n\n    5. Verify all components render correctly at http://localhost:3000\n\n    Restrictions:\n    - Use ONLY shadcn/ui components (no Material-UI, Chakra, etc.)\n    - Do NOT modify component source code in src/components/ui\n    - Do NOT install unnecessary shadcn components beyond the 8 listed\n    - Follow CLAUDE.md design system rules strictly\n\n    Success:\n    - All 8 components installed and render without errors\n    - cn() utility works for className merging\n    - Components use custom Tailwind theme (primary, secondary colors)\n    - TypeScript types are correct\n    - Components are accessible (WCAG AA compliant)\n\n    After completion:\n    - Use log-implementation tool with taskId \"6\" including component artifacts\n    - Mark task as complete in tasks.md\n    ```\n\n---\n\n## Task 7: Database Setup (Prisma + Postgres)\n\n- [ ] **7. Configure Prisma with Lead and Appointment models, run initial migration**\n  - **Files to create:**\n    - `prisma/schema.prisma`\n    - `prisma/migrations/` (via prisma migrate)\n    - `src/lib/db/client.ts`\n    - `.env.local` (copy from .env.example)\n  - **Purpose:** Establish database layer with type-safe Prisma client\n  - **Leverage:** .env.example from Task 2\n  - **Requirements:** Requirement 4 (Database Setup - Prisma + Postgres)\n  - **Success Criteria:**\n    - Prisma schema defines Lead and Appointment models\n    - Initial migration created and applied\n    - Prisma client singleton works\n    - `pnpm db:generate` and `pnpm db:studio` work\n    - Database connection succeeds\n\n  - **_Prompt:**\n    ```\n    Implement the task for spec foundation-setup, first run spec-workflow-guide to get the workflow guide then implement the task:\n\n    Role: Backend Developer with expertise in Prisma ORM and PostgreSQL\n\n    Task: Set up Prisma with Lead and Appointment models matching tech.md database schema. Create Prisma client singleton with hot-reload handling. Follow Requirement 4 from requirements.md and design.md data models section.\n\n    Steps:\n    1. Install Prisma:\n       ```bash\n       pnpm add @prisma/client\n       pnpm add -D prisma\n       ```\n\n    2. Create `prisma/schema.prisma`:\n       ```prisma\n       generator client {\n         provider = \"prisma-client-js\"\n       }\n\n       datasource db {\n         provider = \"postgresql\"\n         url      = env(\"DATABASE_URL\")\n       }\n\n       model Lead {\n         id            String   @id @default(cuid())\n         email         String   @unique\n         name          String?\n         phone         String?\n         region        String\n         schoolType    String\n         needType      String\n         timeframe     String?\n         contactMethod String\n         source        String?\n         consentFlags  Json\n         notes         String?\n         n8nProcessed  Boolean  @default(false)\n         n8nJobId      String?\n         createdAt     DateTime @default(now())\n         updatedAt     DateTime @updatedAt\n\n         @@index([email])\n         @@index([createdAt])\n       }\n\n       model Appointment {\n         id              String   @id @default(cuid())\n         leadEmail       String\n         calBookingId    String   @unique\n         calEventId      String\n         timeSlot        DateTime\n         status          String\n         rescheduleCount Int      @default(0)\n         createdAt       DateTime @default(now())\n         updatedAt       DateTime @updatedAt\n\n         @@index([leadEmail])\n         @@index([timeSlot])\n       }\n       ```\n\n    3. Create `.env.local` (copy from .env.example):\n       ```bash\n       cp .env.example .env.local\n       ```\n       Update DATABASE_URL with real Postgres connection string\n\n    4. Create `src/lib/db/client.ts`:\n       ```typescript\n       import { PrismaClient } from '@prisma/client'\n\n       const globalForPrisma = global as unknown as { prisma: PrismaClient }\n\n       export const prisma = globalForPrisma.prisma || new PrismaClient()\n\n       if (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\n       ```\n\n    5. Add npm scripts to package.json:\n       ```json\n       {\n         \"db:generate\": \"prisma generate\",\n         \"db:migrate\": \"prisma migrate dev\",\n         \"db:migrate:deploy\": \"prisma migrate deploy\",\n         \"db:studio\": \"prisma studio\",\n         \"db:reset\": \"prisma migrate reset\"\n       }\n       ```\n\n    6. Generate Prisma client and create initial migration:\n       ```bash\n       pnpm db:generate\n       pnpm db:migrate --name init\n       ```\n\n    7. Test Prisma Studio: `pnpm db:studio` (opens http://localhost:5555)\n\n    Restrictions:\n    - Follow exact schema from tech.md lines 317-352\n    - Do NOT use Drizzle ORM or other ORMs\n    - Ensure prisma/migrations/ is committed to git (not in .gitignore)\n    - Use cuid() for IDs (not uuid or autoincrement)\n\n    Success:\n    - Prisma client generates without errors\n    - Migration applies successfully to database\n    - Prisma Studio opens and shows Lead/Appointment tables\n    - TypeScript types are inferred (Lead, Appointment)\n    - Singleton pattern prevents multiple instances in dev\n\n    After completion:\n    - Use log-implementation tool with taskId \"7\" including database schema artifacts\n    - Mark task as complete in tasks.md\n    ```\n\n---\n\n## Task 8: Validation Schemas (Zod)\n\n- [ ] **8. Create Zod validation schemas (common validators + leadSchema) with unit tests**\n  - **Files to create:**\n    - `src/lib/forms/schemas/common.ts`\n    - `src/lib/forms/schemas/lead-schema.ts`\n    - `tests/unit/schemas/lead-schema.test.ts`\n  - **Purpose:** Establish type-safe validation for all user inputs\n  - **Leverage:** Testing infrastructure from Task 3\n  - **Requirements:** Requirement 5 (Validation Schemas - Zod), Requirement 9 (Unit Tests for schemas)\n  - **Success Criteria:**\n    - Common validators exported (plz, email, phone, name, enums, consent)\n    - leadSchema defined and typed\n    - Unit tests pass with good coverage\n    - German error messages\n    - `pnpm test` runs successfully\n\n  - **_Prompt:**\n    ```\n    Implement the task for spec foundation-setup, first run spec-workflow-guide to get the workflow guide then implement the task:\n\n    Role: Backend Developer with expertise in Zod validation and TypeScript\n\n    Task: Create reusable Zod validation schemas for common inputs (PLZ, email, phone) and Lead entity. Write comprehensive unit tests. Follow Requirement 5 from requirements.md and design.md Zod schemas section.\n\n    Steps:\n    1. Install Zod: `pnpm add zod`\n\n    2. Create `src/lib/forms/schemas/common.ts`:\n       ```typescript\n       import { z } from 'zod'\n\n       // Reusable validators\n       export const plzSchema = z\n         .string()\n         .regex(/^\\d{5}$/, 'Bitte geben Sie eine gültige 5-stellige PLZ ein')\n\n       export const emailSchema = z\n         .string()\n         .email('Bitte geben Sie eine gültige E-Mail-Adresse ein')\n\n       export const phoneSchema = z\n         .string()\n         .regex(\n           /^(\\+49|0)[1-9]\\d{1,14}$/,\n           'Bitte geben Sie eine gültige Telefonnummer ein'\n         )\n         .optional()\n\n       export const nameSchema = z\n         .string()\n         .min(2, 'Name muss mindestens 2 Zeichen lang sein')\n         .max(100, 'Name darf maximal 100 Zeichen lang sein')\n\n       // School types\n       export const schoolTypeSchema = z.enum([\n         'grundschule',\n         'gymnasium',\n         'realschule',\n         'gesamtschule',\n         'foerderschule',\n         'sonstige',\n       ])\n\n       // Need types\n       export const needTypeSchema = z.enum([\n         'lernfoerderung',\n         'sozial-emotional',\n         'koerperlich-motorisch',\n         'mehrfachbedarf',\n       ])\n\n       // Consent\n       export const consentFlagsSchema = z.object({\n         essentiell: z.literal(true),\n         analytics: z.boolean(),\n       })\n       ```\n\n    3. Create `src/lib/forms/schemas/lead-schema.ts`:\n       ```typescript\n       import { z } from 'zod'\n       import {\n         plzSchema,\n         emailSchema,\n         phoneSchema,\n         nameSchema,\n         schoolTypeSchema,\n         needTypeSchema,\n         consentFlagsSchema,\n       } from './common'\n\n       export const leadSchema = z.object({\n         email: emailSchema,\n         name: nameSchema.optional(),\n         phone: phoneSchema,\n         region: plzSchema,\n         schoolType: schoolTypeSchema,\n         needType: needTypeSchema,\n         timeframe: z\n           .enum(['sofort', '1-3-monate', '3-6-monate', 'flexibel'])\n           .optional(),\n         contactMethod: z.enum(['termin', 'rueckruf', 'email']),\n         consentFlags: consentFlagsSchema,\n         source: z.string().optional(),\n         notes: z.string().max(500).optional(),\n       })\n\n       export type LeadInput = z.infer<typeof leadSchema>\n       ```\n\n    4. Create `tests/unit/schemas/lead-schema.test.ts`:\n       ```typescript\n       import { describe, it, expect } from 'vitest'\n       import { leadSchema, plzSchema, emailSchema } from '@/lib/forms/schemas'\n\n       describe('leadSchema', () => {\n         it('should validate a valid lead', () => {\n           const validLead = {\n             email: 'anna@example.com',\n             region: '10115',\n             schoolType: 'grundschule',\n             needType: 'lernfoerderung',\n             contactMethod: 'termin',\n             consentFlags: { essentiell: true, analytics: true },\n           }\n\n           const result = leadSchema.safeParse(validLead)\n           expect(result.success).toBe(true)\n         })\n\n         it('should fail on invalid email', () => {\n           const invalidLead = {\n             email: 'not-an-email',\n             region: '10115',\n             schoolType: 'grundschule',\n             needType: 'lernfoerderung',\n             contactMethod: 'termin',\n             consentFlags: { essentiell: true, analytics: true },\n           }\n\n           const result = leadSchema.safeParse(invalidLead)\n           expect(result.success).toBe(false)\n         })\n\n         it('should fail on invalid PLZ (4 digits)', () => {\n           const invalidLead = {\n             email: 'anna@example.com',\n             region: '1234',\n             schoolType: 'grundschule',\n             needType: 'lernfoerderung',\n             contactMethod: 'termin',\n             consentFlags: { essentiell: true, analytics: true },\n           }\n\n           const result = leadSchema.safeParse(invalidLead)\n           expect(result.success).toBe(false)\n           if (!result.success) {\n             expect(result.error.issues[0].message).toContain('5-stellige PLZ')\n           }\n         })\n\n         it('should fail if notes exceed 500 chars', () => {\n           const invalidLead = {\n             email: 'anna@example.com',\n             region: '10115',\n             schoolType: 'grundschule',\n             needType: 'lernfoerderung',\n             contactMethod: 'termin',\n             consentFlags: { essentiell: true, analytics: true },\n             notes: 'a'.repeat(501),\n           }\n\n           const result = leadSchema.safeParse(invalidLead)\n           expect(result.success).toBe(false)\n         })\n\n         it('should allow optional fields to be omitted', () => {\n           const minimalLead = {\n             email: 'anna@example.com',\n             region: '10115',\n             schoolType: 'grundschule',\n             needType: 'lernfoerderung',\n             contactMethod: 'termin',\n             consentFlags: { essentiell: true, analytics: false },\n           }\n\n           const result = leadSchema.safeParse(minimalLead)\n           expect(result.success).toBe(true)\n         })\n       })\n\n       describe('plzSchema', () => {\n         it('should validate 5-digit PLZ', () => {\n           expect(plzSchema.safeParse('10115').success).toBe(true)\n         })\n\n         it('should fail on 4-digit PLZ', () => {\n           expect(plzSchema.safeParse('1234').success).toBe(false)\n         })\n\n         it('should fail on letters in PLZ', () => {\n           expect(plzSchema.safeParse('1234a').success).toBe(false)\n         })\n       })\n       ```\n\n    5. Run tests: `pnpm test`\n\n    Restrictions:\n    - Use Zod only (not Yup, Joi, or other validation libraries)\n    - Error messages must be in German\n    - Follow exact field definitions from requirements.md\n    - Test both success and failure scenarios\n\n    Success:\n    - All unit tests pass (`pnpm test`)\n    - leadSchema matches Prisma Lead model\n    - German error messages work\n    - Type inference works (LeadInput type)\n    - Edge cases covered in tests\n\n    After completion:\n    - Use log-implementation tool with taskId \"8\" including validation schema artifacts\n    - Mark task as complete in tasks.md\n    ```\n\n---\n\n## Task 9: Form Components (React Hook Form + Zod)\n\n- [ ] **9. Create TextInput component integrated with React Hook Form, render on home page**\n  - **Files to create:**\n    - `src/components/forms/text-input.tsx`\n    - Update `app/page.tsx` to test component visually\n  - **Purpose:** Create reusable form input component as template for future forms\n  - **Leverage:** shadcn/ui Input from Task 6, Zod schemas from Task 8\n  - **Requirements:** Requirement 6 (Form Handling Setup - React Hook Form)\n  - **Success Criteria:**\n    - TextInput component works with useFormContext\n    - Displays label, input, helpText, and errors\n    - Visual test on home page shows component\n    - TypeScript types are correct\n    - Accessible (ARIA attributes)\n\n  - **_Prompt:**\n    ```\n    Implement the task for spec foundation-setup, first run spec-workflow-guide to get the workflow guide then implement the task:\n\n    Role: Frontend Developer with expertise in React Hook Form and accessible forms\n\n    Task: Create reusable TextInput form component integrated with React Hook Form and shadcn/ui Input. Test visually on home page. Follow Requirement 6 from requirements.md and design.md form components section.\n\n    Steps:\n    1. Install React Hook Form:\n       ```bash\n       pnpm add react-hook-form @hookform/resolvers\n       ```\n\n    2. Create `src/components/forms/text-input.tsx`:\n       ```tsx\n       'use client'\n\n       import { forwardRef } from 'react'\n       import { useFormContext } from 'react-hook-form'\n       import { Input } from '@/components/ui/input'\n       import { Label } from '@/components/ui/label'\n\n       interface TextInputProps {\n         name: string\n         label: string\n         placeholder?: string\n         helpText?: string\n         required?: boolean\n         type?: 'text' | 'email' | 'tel' | 'number'\n       }\n\n       export const TextInput = forwardRef<HTMLInputElement, TextInputProps>(\n         ({ name, label, placeholder, helpText, required, type = 'text' }, ref) => {\n           const {\n             register,\n             formState: { errors },\n           } = useFormContext()\n\n           return (\n             <div className=\"space-y-1\">\n               <Label htmlFor={name}>\n                 {label}\n                 {required && <span className=\"text-red-500 ml-1\">*</span>}\n               </Label>\n               <Input\n                 id={name}\n                 type={type}\n                 {...register(name)}\n                 ref={ref}\n                 placeholder={placeholder}\n                 aria-invalid={errors[name] ? 'true' : 'false'}\n                 aria-describedby={errors[name] ? `${name}-error` : undefined}\n               />\n               {helpText && <p className=\"text-sm text-gray-500\">{helpText}</p>}\n               {errors[name] && (\n                 <p id={`${name}-error`} className=\"text-sm text-red-500\">\n                   {errors[name]?.message as string}\n                 </p>\n               )}\n             </div>\n           )\n         }\n       )\n\n       TextInput.displayName = 'TextInput'\n       ```\n\n    3. Update `app/page.tsx` to test component visually:\n       ```tsx\n       'use client'\n\n       import { FormProvider, useForm } from 'react-hook-form'\n       import { zodResolver } from '@hookform/resolvers/zod'\n       import { z } from 'zod'\n       import { TextInput } from '@/components/forms/text-input'\n       import { Button } from '@/components/ui/button'\n       import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\n\n       const testSchema = z.object({\n         name: z.string().min(2, 'Name muss mindestens 2 Zeichen lang sein'),\n         email: z.string().email('Ungültige E-Mail-Adresse'),\n       })\n\n       export default function Home() {\n         const methods = useForm({\n           resolver: zodResolver(testSchema),\n         })\n\n         const onSubmit = (data: any) => {\n           console.log('Form data:', data)\n           alert('Form submitted! Check console.')\n         }\n\n         return (\n           <main className=\"flex min-h-screen flex-col items-center justify-center p-24\">\n             <div className=\"text-center mb-8\">\n               <h1 className=\"text-4xl font-bold mb-4\">Decari MVP</h1>\n               <p className=\"text-xl text-gray-600\">Foundation Setup - Form Test</p>\n             </div>\n\n             <Card className=\"max-w-md w-full\">\n               <CardHeader>\n                 <CardTitle>Form Component Test</CardTitle>\n               </CardHeader>\n               <CardContent>\n                 <FormProvider {...methods}>\n                   <form onSubmit={methods.handleSubmit(onSubmit)} className=\"space-y-4\">\n                     <TextInput\n                       name=\"name\"\n                       label=\"Name\"\n                       placeholder=\"Ihr Name\"\n                       helpText=\"Mindestens 2 Zeichen\"\n                       required\n                     />\n                     <TextInput\n                       name=\"email\"\n                       label=\"E-Mail\"\n                       type=\"email\"\n                       placeholder=\"ihre@email.de\"\n                       required\n                     />\n                     <Button type=\"submit\">Absenden</Button>\n                   </form>\n                 </FormProvider>\n               </CardContent>\n             </Card>\n           </main>\n         )\n       }\n       ```\n\n    4. Test visually:\n       - Visit http://localhost:3000\n       - Try submitting empty form (should show errors)\n       - Enter invalid email (should show error)\n       - Enter valid data (should log to console)\n\n    Restrictions:\n    - Use useFormContext (not useForm directly in component)\n    - Integrate with shadcn/ui Input (do not create custom input)\n    - Include ARIA attributes for accessibility\n    - Display inline validation errors\n\n    Success:\n    - TextInput renders correctly with label and input\n    - Validation errors display inline\n    - Required indicator shows (red asterisk)\n    - Form submission works with valid data\n    - Accessible (ARIA attributes present)\n\n    After completion:\n    - Use log-implementation tool with taskId \"9\" including form component artifacts\n    - Mark task as complete in tasks.md\n    ```\n\n---\n\n## Task 10: Environment Variables (Type-Safe)\n\n- [ ] **10. Create type-safe environment variable validation with @t3-oss/env-nextjs**\n  - **Files to create:**\n    - `src/lib/env.ts`\n  - **Purpose:** Ensure all required env vars are validated at build time\n  - **Leverage:** .env.example from Task 2, Zod from Task 8\n  - **Requirements:** Requirement 10 (Environment Variables & Configuration)\n  - **Success Criteria:**\n    - All env vars validated at build time\n    - TypeScript types inferred\n    - Build fails if required vars missing\n    - Type-safe access throughout app\n    - Clear error messages\n\n  - **_Prompt:**\n    ```\n    Implement the task for spec foundation-setup, first run spec-workflow-guide to get the workflow guide then implement the task:\n\n    Role: DevOps Engineer with expertise in environment configuration and TypeScript\n\n    Task: Create type-safe environment variable validation using @t3-oss/env-nextjs. Ensure all required vars from .env.example are validated at build time. Follow Requirement 10 from requirements.md.\n\n    Steps:\n    1. Install @t3-oss/env-nextjs:\n       ```bash\n       pnpm add @t3-oss/env-nextjs\n       ```\n\n    2. Create `src/lib/env.ts`:\n       ```typescript\n       import { createEnv } from '@t3-oss/env-nextjs'\n       import { z } from 'zod'\n\n       export const env = createEnv({\n         /**\n          * Server-side environment variables (not exposed to client)\n          */\n         server: {\n           DATABASE_URL: z.string().url(),\n           CAL_WEBHOOK_SECRET: z.string().min(1),\n           N8N_WEBHOOK_URL: z.string().url(),\n           N8N_WEBHOOK_SECRET: z.string().optional(),\n         },\n\n         /**\n          * Client-side environment variables (exposed via NEXT_PUBLIC_*)\n          */\n         client: {\n           NEXT_PUBLIC_POSTHOG_KEY: z.string().min(1),\n           NEXT_PUBLIC_POSTHOG_HOST: z.string().url(),\n           NEXT_PUBLIC_CAL_LINK: z.string().url(),\n         },\n\n         /**\n          * Runtime environment variables mapping\n          */\n         runtimeEnv: {\n           // Server\n           DATABASE_URL: process.env.DATABASE_URL,\n           CAL_WEBHOOK_SECRET: process.env.CAL_WEBHOOK_SECRET,\n           N8N_WEBHOOK_URL: process.env.N8N_WEBHOOK_URL,\n           N8N_WEBHOOK_SECRET: process.env.N8N_WEBHOOK_SECRET,\n\n           // Client\n           NEXT_PUBLIC_POSTHOG_KEY: process.env.NEXT_PUBLIC_POSTHOG_KEY,\n           NEXT_PUBLIC_POSTHOG_HOST: process.env.NEXT_PUBLIC_POSTHOG_HOST,\n           NEXT_PUBLIC_CAL_LINK: process.env.NEXT_PUBLIC_CAL_LINK,\n         },\n\n         /**\n          * Skip validation in dev if needed (optional)\n          */\n         skipValidation: !!process.env.SKIP_ENV_VALIDATION,\n       })\n       ```\n\n    3. Test validation:\n       - Temporarily remove DATABASE_URL from .env.local\n       - Run `pnpm build`\n       - Should fail with clear error message\n       - Restore DATABASE_URL\n       - Run `pnpm build` again - should succeed\n\n    4. Example usage in code:\n       ```typescript\n       // In a server component or API route:\n       import { env } from '@/lib/env'\n\n       const dbUrl = env.DATABASE_URL  // Type-safe, validated\n       const posthogKey = env.NEXT_PUBLIC_POSTHOG_KEY  // Also accessible client-side\n       ```\n\n    Restrictions:\n    - Use @t3-oss/env-nextjs (recommended in requirements.md)\n    - Do NOT skip validation in production\n    - Server vars must NOT be exposed to client\n    - Follow exact var names from .env.example\n\n    Success:\n    - Build-time validation works (pnpm build fails if vars missing)\n    - TypeScript autocomplete works for env vars\n    - Clear error messages if vars missing\n    - Type-safe access (env.DATABASE_URL is typed)\n    - No runtime errors for missing vars\n\n    After completion:\n    - Use log-implementation tool with taskId \"10\"\n    - Mark task as complete in tasks.md\n    ```\n\n---\n\n## Task 11: PostHog Analytics Initialization\n\n- [ ] **11. Create PostHog initialization with consent management and event_id generation**\n  - **Files to create:**\n    - `src/lib/analytics/posthog.ts`\n    - Update `app/layout.tsx` to initialize PostHog\n  - **Purpose:** Set up analytics infrastructure for event tracking\n  - **Leverage:** Environment variables from Task 10\n  - **Requirements:** Requirement 12 (PostHog Analytics Initialization)\n  - **Success Criteria:**\n    - PostHog initializes client-side only\n    - Consent check before tracking\n    - event_id generation for Meta Ads deduplication\n    - Session recording/heatmaps/feature flags disabled\n    - page_view events captured automatically\n\n  - **_Prompt:**\n    ```\n    Implement the task for spec foundation-setup, first run spec-workflow-guide to get the workflow guide then implement the task:\n\n    Role: Analytics Engineer with expertise in PostHog and GDPR-compliant tracking\n\n    Task: Initialize PostHog for event tracking with consent management and Meta Ads deduplication support. Follow Requirement 12 from requirements.md and tech.md Meta Ads integration section.\n\n    Steps:\n    1. Install PostHog:\n       ```bash\n       pnpm add posthog-js\n       ```\n\n    2. Create `src/lib/analytics/posthog.ts`:\n       ```typescript\n       'use client'\n\n       import posthog from 'posthog-js'\n       import { env } from '@/lib/env'\n\n       export function initPostHog() {\n         if (typeof window !== 'undefined') {\n           posthog.init(env.NEXT_PUBLIC_POSTHOG_KEY, {\n             api_host: env.NEXT_PUBLIC_POSTHOG_HOST,\n             loaded: (posthog) => {\n               if (process.env.NODE_ENV === 'development') posthog.debug()\n             },\n             capture_pageview: true,\n             capture_pageleave: true,\n             // Disable MVP-excluded features per tech.md v1.6\n             session_recording: {\n               enabled: false,\n             },\n             autocapture: false,\n             disable_session_recording: true,\n           })\n         }\n       }\n\n       export function trackEvent(\n         eventName: string,\n         properties?: Record<string, any>\n       ) {\n         if (typeof window !== 'undefined' && hasAnalyticsConsent()) {\n           posthog.capture(eventName, {\n             event_id: crypto.randomUUID(), // For Meta Ads deduplication\n             ...properties,\n           })\n         }\n       }\n\n       // Simple consent check (will be replaced with real consent banner later)\n       function hasAnalyticsConsent(): boolean {\n         if (typeof window === 'undefined') return false\n         // Placeholder: check localStorage or cookie\n         // For now, default to true (will be implemented with consent banner)\n         return true\n       }\n\n       export { posthog }\n       ```\n\n    3. Update `app/layout.tsx` to initialize PostHog:\n       ```tsx\n       'use client'\n\n       import { useEffect } from 'react'\n       import { initPostHog } from '@/lib/analytics/posthog'\n\n       // Add this component\n       function PostHogProvider({ children }: { children: React.ReactNode }) {\n         useEffect(() => {\n           initPostHog()\n         }, [])\n\n         return <>{children}</>\n       }\n\n       // Wrap children in RootLayout:\n       export default function RootLayout({\n         children,\n       }: {\n         children: React.ReactNode\n       }) {\n         return (\n           <html lang=\"de\">\n             <body className={inter.className}>\n               <PostHogProvider>{children}</PostHogProvider>\n             </body>\n           </html>\n         )\n       }\n       ```\n\n    4. Test PostHog:\n       - Ensure NEXT_PUBLIC_POSTHOG_KEY and NEXT_PUBLIC_POSTHOG_HOST are in .env.local\n       - Run `pnpm dev`\n       - Open browser DevTools → Network tab\n       - Filter for \"posthog\" or \"eu.posthog.com\"\n       - Visit http://localhost:3000\n       - Should see page_view event sent to PostHog\n\n    Restrictions:\n    - Initialize ONLY on client-side (typeof window check)\n    - Disable session recording, heatmaps, feature flags (MVP scope)\n    - Generate unique event_id for every event (Meta Ads deduplication)\n    - Respect consent flags (trackEvent checks consent)\n\n    Success:\n    - PostHog initializes without errors\n    - page_view events sent automatically\n    - event_id generated for each event\n    - Session recording disabled\n    - Consent check works (placeholder for now)\n\n    After completion:\n    - Use log-implementation tool with taskId \"11\" including analytics setup artifacts\n    - Mark task as complete in tasks.md\n    ```\n\n---\n\n## Task 12: Documentation & README\n\n- [ ] **12. Update README.md with setup instructions, npm scripts, and development workflow**\n  - **Files to modify:**\n    - `README.md`\n  - **Purpose:** Document project setup for developers and AI agents\n  - **Leverage:** All previous tasks\n  - **Requirements:** Requirement 7 (Development Scripts & Configuration)\n  - **Success Criteria:**\n    - README explains project purpose\n    - Setup instructions complete (clone → run)\n    - All npm scripts documented\n    - Environment variables documented\n    - Development workflow explained\n\n  - **_Prompt:**\n    ```\n    Implement the task for spec foundation-setup, first run spec-workflow-guide to get the workflow guide then implement the task:\n\n    Role: Technical Writer with expertise in developer documentation\n\n    Task: Create comprehensive README.md documenting project setup, npm scripts, environment variables, and development workflow. Follow requirements.md Requirement 7 and design.md.\n\n    Steps:\n    1. Update `README.md`:\n       ```markdown\n       # Decari MVP\n\n       Content- und Funnel-Website für qualifizierte Schulbegleitung. Hilft Eltern, Schulen und Institutionen schnell die passende Unterstützung zu finden.\n\n       ## Tech Stack\n\n       - **Framework:** Next.js 15 (App Router)\n       - **Language:** TypeScript 5.3+ (strict mode)\n       - **Styling:** Tailwind CSS 4.0+\n       - **UI Components:** shadcn/ui (Radix UI primitives)\n       - **Database:** PostgreSQL via Prisma 5.7+\n       - **Validation:** Zod 3.22+\n       - **Forms:** React Hook Form 7.5+\n       - **Analytics:** PostHog (EU region)\n       - **Package Manager:** pnpm 8+\n       - **Testing:** Vitest (unit) + Playwright (E2E)\n\n       ## Prerequisites\n\n       - Node.js 20 LTS\n       - pnpm 8+\n       - PostgreSQL database (local or Vercel Postgres)\n\n       ## Setup\n\n       1. **Clone repository:**\n          ```bash\n          git clone <repo-url>\n          cd schulbegleitung\n          ```\n\n       2. **Install dependencies:**\n          ```bash\n          pnpm install\n          ```\n\n       3. **Set up environment variables:**\n          ```bash\n          cp .env.example .env.local\n          ```\n          Fill in real values in `.env.local`:\n          - `DATABASE_URL` - Postgres connection string\n          - `NEXT_PUBLIC_POSTHOG_KEY` - PostHog API key\n          - `NEXT_PUBLIC_POSTHOG_HOST` - `https://eu.posthog.com`\n          - Other vars as needed (see `.env.example`)\n\n       4. **Set up database:**\n          ```bash\n          pnpm db:generate        # Generate Prisma client\n          pnpm db:migrate         # Run migrations\n          ```\n\n       5. **Run development server:**\n          ```bash\n          pnpm dev\n          ```\n          Open [http://localhost:3000](http://localhost:3000)\n\n       ## Available Scripts\n\n       ### Development\n       - `pnpm dev` - Start development server (http://localhost:3000)\n       - `pnpm build` - Build for production\n       - `pnpm start` - Start production server\n\n       ### Code Quality\n       - `pnpm lint` - Run ESLint\n       - `pnpm format` - Format code with Prettier\n       - `pnpm format:check` - Check formatting (CI)\n       - `pnpm type-check` - Run TypeScript type checking\n\n       ### Testing\n       - `pnpm test` - Run unit tests (Vitest, watch mode)\n       - `pnpm test:coverage` - Generate coverage report\n       - `pnpm e2e` - Run E2E tests (Playwright, headless)\n       - `pnpm e2e:ui` - Run E2E tests with UI\n\n       ### Database\n       - `pnpm db:generate` - Generate Prisma client\n       - `pnpm db:migrate` - Create & apply migration (dev)\n       - `pnpm db:migrate:deploy` - Apply migrations (production)\n       - `pnpm db:studio` - Open Prisma Studio (GUI)\n       - `pnpm db:reset` - Reset database (dev only)\n\n       ## Project Structure\n\n       ```\n       schulbegleitung/\n       ├── app/                    # Next.js App Router\n       │   ├── (marketing)/        # Public pages\n       │   ├── (funnel)/           # Intake funnel\n       │   ├── api/                # API routes\n       │   ├── layout.tsx          # Root layout\n       │   └── page.tsx            # Home page\n       │\n       ├── src/\n       │   ├── components/\n       │   │   ├── ui/             # shadcn/ui components\n       │   │   └── forms/          # Form components\n       │   ├── lib/\n       │   │   ├── db/             # Prisma client\n       │   │   ├── forms/schemas/  # Zod schemas\n       │   │   ├── analytics/      # PostHog\n       │   │   └── utils/          # Utilities\n       │   └── types/              # TypeScript types\n       │\n       ├── prisma/\n       │   ├── schema.prisma       # Database schema\n       │   └── migrations/         # Migration history\n       │\n       ├── tests/\n       │   ├── unit/               # Unit tests\n       │   └── e2e/                # E2E tests\n       │\n       └── .spec-workflow/         # Specification docs\n       ```\n\n       ## Development Workflow\n\n       1. **Create feature branch:** `git checkout -b feature/my-feature`\n       2. **Make changes and test:**\n          - Run `pnpm dev` for live reload\n          - Run `pnpm test` for unit tests\n          - Run `pnpm lint` before commit\n       3. **Commit:** Follow Conventional Commits (`feat:`, `fix:`, etc.)\n       4. **Push and create PR:** CI will run tests and linting\n       5. **Ultracite AI Review:** Automatic code review via GitHub App\n\n       ## Steering Documents\n\n       See `.spec-workflow/steering/` for:\n       - `product.md` - Product vision and requirements\n       - `tech.md` - Technology stack and decisions\n       - `structure.md` - Code organization and naming conventions\n\n       ## License\n\n       Proprietary - Decari © 2025\n       ```\n\n    2. Verify all links and commands work\n\n    Restrictions:\n    - Keep README concise but complete\n    - Document ALL npm scripts from package.json\n    - Ensure setup instructions are step-by-step\n    - Reference steering documents\n\n    Success:\n    - New developer can clone and run project following README\n    - All npm scripts are documented\n    - Project structure is clear\n    - Environment variables are explained\n    - README is well-formatted and easy to read\n\n    After completion:\n    - Use log-implementation tool with taskId \"12\"\n    - Mark task as complete in tasks.md\n    - Foundation setup is COMPLETE! 🎉\n    ```\n\n---\n\n## E2E Test Example (Bonus Task - Optional)\n\n- [ ] **13. Create basic E2E test for home page (Optional, can be done later)**\n  - **Files to create:**\n    - `tests/e2e/home.spec.ts`\n  - **Purpose:** Verify foundation setup with automated E2E test\n  - **Leverage:** Playwright from Task 3, home page from Task 4\n  - **Requirements:** Requirement 9 (Testing Framework - E2E)\n  - **Success Criteria:**\n    - E2E test passes\n    - Verifies home page loads\n    - Checks for no console errors\n    - `pnpm e2e` runs successfully\n\n  - **_Prompt:**\n    ```\n    Implement the task for spec foundation-setup, first run spec-workflow-guide to get the workflow guide then implement the task:\n\n    Role: QA Engineer with expertise in Playwright E2E testing\n\n    Task: Create basic end-to-end test for home page to verify foundation setup. Follow testing strategy from design.md.\n\n    Steps:\n    1. Create `tests/e2e/home.spec.ts`:\n       ```typescript\n       import { test, expect } from '@playwright/test'\n\n       test.describe('Home Page', () => {\n         test('should load successfully', async ({ page }) => {\n           await page.goto('/')\n\n           // Check title\n           await expect(page).toHaveTitle(/Decari/)\n\n           // Check heading\n           await expect(page.locator('h1')).toContainText('Decari MVP')\n\n           // Check description\n           await expect(page.locator('text=Foundation Setup')).toBeVisible()\n         })\n\n         test('should have no console errors', async ({ page }) => {\n           const errors: string[] = []\n\n           page.on('console', (msg) => {\n             if (msg.type() === 'error') {\n               errors.push(msg.text())\n             }\n           })\n\n           await page.goto('/')\n\n           // Wait for page to fully load\n           await page.waitForLoadState('networkidle')\n\n           // Check for errors\n           expect(errors).toHaveLength(0)\n         })\n\n         test('should load PostHog', async ({ page }) => {\n           // Intercept PostHog requests\n           let posthogLoaded = false\n\n           page.on('request', (request) => {\n             if (request.url().includes('posthog') || request.url().includes('eu.posthog.com')) {\n               posthogLoaded = true\n             }\n           })\n\n           await page.goto('/')\n           await page.waitForLoadState('networkidle')\n\n           // PostHog should have loaded (if env vars are set)\n           expect(posthogLoaded).toBe(true)\n         })\n       })\n       ```\n\n    2. Run E2E tests:\n       ```bash\n       pnpm e2e\n       ```\n\n    3. If tests fail, debug with UI:\n       ```bash\n       pnpm e2e:ui\n       ```\n\n    Restrictions:\n    - Keep tests simple (only verify foundation works)\n    - Test only critical paths (home page load)\n    - Do NOT test features not yet implemented\n\n    Success:\n    - `pnpm e2e` passes all tests\n    - Home page loads without errors\n    - PostHog initialization verified\n    - Tests run reliably in CI\n\n    After completion:\n    - Use log-implementation tool with taskId \"13\"\n    - Mark task as complete in tasks.md\n    ```\n\n---\n\n## Task Completion Checklist\n\nAfter all tasks are complete:\n\n- [ ] All 12 main tasks marked as [x] in tasks.md\n- [ ] `pnpm dev` starts without errors\n- [ ] `pnpm build` succeeds\n- [ ] `pnpm test` passes (with Zod schema tests)\n- [ ] `pnpm lint` and `pnpm format` succeed\n- [ ] `pnpm db:studio` shows Lead and Appointment tables\n- [ ] PostHog events visible in dashboard (if API key configured)\n- [ ] README.md is complete and accurate\n- [ ] All log-implementation entries created with detailed artifacts\n- [ ] Foundation is ready for feature development! 🚀\n\n---\n\n**Note for AI Agents:**\n\nEach task includes a detailed `_Prompt` field with:\n- **Role:** Specialized developer role for the task\n- **Task:** Clear description with context references\n- **Steps:** Exact implementation steps with code snippets\n- **Restrictions:** What NOT to do, constraints to follow\n- **Success:** Specific completion criteria\n\n**Workflow per task:**\n1. Mark task as in-progress in tasks.md: `[ ]` → `[-]`\n2. Follow the _Prompt instructions exactly\n3. Test the implementation\n4. Use `log-implementation` tool with detailed artifacts (APIs, components, functions, etc.)\n5. Mark task as complete in tasks.md: `[-]` → `[x]`\n\n**Critical:** Use `get-implementation-logs` with keywords BEFORE implementing to discover existing code and avoid duplication.\n",
  "fileStats": {
    "size": 61750,
    "lines": 1832,
    "lastModified": "2025-11-10T12:56:20.226Z"
  },
  "comments": []
}